--- a/xla/BUILD
+++ b/xla/BUILD
@@ -29,6 +29,7 @@ package_group(
         "//third_party/py/tpu_graphs/...",
         "//tensorflow/compiler/...",
         "//tensorflow/python/tpu/...",
+        "public",
     ],
 )
 

--- a/xla/python/BUILD
+++ b/xla/python/BUILD
@@ -1134,6 +1134,10 @@ cc_library(
         "//xla:statusor",
         "//xla:types",
         "//xla:util",
+        "//xla:xla_data_proto_cc",
+        "//xla:xla_data_proto_cc_impl",
+        "//xla:xla_proto_cc",
+        "//xla:xla_proto_cc_impl",
         "//xla/pjrt:mlir_to_hlo",
         "//xla/pjrt:pjrt_api",
         "//xla/pjrt:pjrt_c_api_client",
@@ -1147,10 +1151,51 @@ cc_library(
         "//xla/pjrt/distributed:service",
         "//xla/python/ifrt",
         "//xla/python/pjrt_ifrt",
+        "//xla/service/gpu:backend_configs_cc",
+        "//xla/service/gpu:backend_configs_cc_impl",
+        "//xla/service:buffer_assignment_proto_cc",
+        "//xla/service:buffer_assignment_proto_cc_impl",
+        "//xla/service:hlo_proto_cc",
+        "//xla/service:hlo_proto_cc_impl",
+        "//xla/stream_executor/gpu:gpu_init_impl",
+        "//xla/stream_executor:device_description_proto_cc",
+        "//xla/stream_executor:device_description_proto_cc_impl",
+        "//xla/stream_executor:stream_executor_impl",
+        "//xla:autotune_results_proto_cc",
+        "//xla:autotune_results_proto_cc_impl",
+        "//xla:autotuning_proto_cc",
+        "//xla:autotuning_proto_cc_impl",
         "@tsl//tsl/distributed_runtime/preemption:preemption_sync_manager",
+        "@tsl//tsl/framework:allocator_registry_impl",
         "@tsl//tsl/platform",
+        "@tsl//tsl/platform:env",
+        "@tsl//tsl/platform:env_impl",
         "@tsl//tsl/platform:logging",
         "@tsl//tsl/platform/cloud:gcs_file_system",
+        "@tsl//tsl/profiler/backends/cpu:traceme_recorder_impl",
+        "@tsl//tsl/profiler/lib:profiler_factory_impl",
+        "@tsl//tsl/profiler/lib:profiler_session_impl",
+        "@tsl//tsl/profiler/protobuf:profiled_instructions_proto_cc",
+        "@tsl//tsl/profiler/protobuf:profiled_instructions_proto_cc_impl",
+        "@tsl//tsl/profiler/protobuf:profiler_analysis_proto_cc",
+        "@tsl//tsl/profiler/protobuf:profiler_analysis_proto_cc_impl",
+        "@tsl//tsl/profiler/protobuf:profiler_options_proto_cc",
+        "@tsl//tsl/profiler/protobuf:profiler_options_proto_cc_impl",
+        "@tsl//tsl/profiler/protobuf:profiler_service_monitor_result_proto_cc",
+        "@tsl//tsl/profiler/protobuf:profiler_service_monitor_result_proto_cc_impl",
+        "@tsl//tsl/profiler/protobuf:profiler_service_proto_cc",
+        "@tsl//tsl/profiler/protobuf:profiler_service_proto_cc_impl",
+        "@tsl//tsl/profiler/protobuf:xplane_proto_cc",
+        "@tsl//tsl/profiler/protobuf:xplane_proto_cc_impl",
+        "@tsl//tsl/profiler/utils:time_utils_impl",
+        "@tsl//tsl/protobuf:coordination_config_proto_cc",
+        "@tsl//tsl/protobuf:coordination_config_proto_cc_impl",
+        "@tsl//tsl/protobuf:bfc_memory_map_proto_cc",
+        "@tsl//tsl/protobuf:bfc_memory_map_proto_cc_impl",
+        "@tsl//tsl/protobuf:distributed_runtime_payloads_proto_cc_impl",
+        "@tsl//tsl/protobuf:dnn_proto_cc_impl",
+        "@tsl//tsl/protobuf:histogram_proto_cc",
+        "@tsl//tsl/protobuf:histogram_proto_cc_impl",
         "@tsl//tsl/python/lib/core:numpy",
         "@pybind11",
     ] + select({
