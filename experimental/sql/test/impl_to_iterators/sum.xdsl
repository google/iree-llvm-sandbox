// RUN: rel_opt.py -p impl-to-iterators %s | filecheck %s

module() {
    %0 : !rel_impl.bag<[!rel_impl.schema_element<"id", !rel_impl.int32>]> = rel_impl.full_table_scan() ["table_name" = "some_name"]
    %1 : !rel_impl.bag<[!rel_impl.schema_element<"id", !rel_impl.int32>]> = rel_impl.aggregate(%0 : !rel_impl.bag<[!rel_impl.schema_element<"id", !rel_impl.int32>]>) ["col_names" = ["id"], "functions" = ["sum"]]
}

//      CHECK: func.func() ["sym_name" = "main", "function_type" = !fun<[], []>, "sym_visibility" = "private"] {
// CHECK-NEXT:     %0 : !iterators.stream<!tuple<[!i32]>> = iterators.sampleInput()
// CHECK-NEXT:     %1 : !iterators.stream<!tuple<[!i32]>> = iterators.reduce(%0 : !iterators.stream<!tuple<[!i32]>>)
// CHECK-NEXT:     iterators.sink(%1 : !iterators.stream<!tuple<[!i32]>>)
// CHECK-NEXT:     func.return()
// CHECK-NEXT:   }
